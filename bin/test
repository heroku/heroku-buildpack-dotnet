#!/usr/bin/env bash
# Usage: bin/test <build-dir> <env-dir>
# See: https://devcenter.heroku.com/articles/testpack-api#bin-test

set -euo pipefail

BUILD_DIR=${1:-}

BUILDPACK_DIR=$(cd "$(dirname "$(dirname "${BASH_SOURCE[0]}")")" && pwd)
source "${BUILDPACK_DIR:?}/lib/output.sh"

cd "${BUILD_DIR}"
dotnet_test_command=(
	dotnet
	test
)
echo "Running '${dotnet_test_command[*]}'" | output::indent
"${dotnet_test_command[@]}" |& output::indent
