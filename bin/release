#!/usr/bin/env bash
# Usage: bin/release <build-dir>
# See: https://devcenter.heroku.com/articles/buildpack-api

set -euo pipefail

BUILD_DIR="${1}"
CNB_BUILD_DIR="${BUILD_DIR}/.heroku/cnb/dotnet"
launch_toml_file="${CNB_BUILD_DIR}/layers/launch.toml"

# Check if launch.toml exists and output default_process_types in YAML
if [[ -f "${launch_toml_file}" ]]; then
	BUILDPACK_DIR=$(cd "$(dirname "$(dirname "${BASH_SOURCE[0]}")")" && pwd)
	python3 "${BUILDPACK_DIR}/lib/parse_launch_toml.py" "${launch_toml_file}" --yaml
fi
